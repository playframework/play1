#{fixture delete:'all', load:'data.yml' /}

#{selenium 'Visit the jobboard'}

	// Hop
	open('/')
	
	// Must be on the default 'Development' category now
	assertText('css=a.selected', 'Development')
	assertTextPresent('Play developper wanted at Zenexity - Paris')
	assertTextPresent('PHP developper wanted at Google - Chicago')
	
	// Switch category
	clickAndWait('link=Business')
	assertText('css=a.selected', 'Business')
	assertTextPresent('CEO wanted at Google - San Fransisco')

	// Back to home
	clickAndWait('link=Play, jobs')
	assertText('css=a.selected', 'Development')
	
	// Follow a job detail link
	clickAndWait('link=Play developper *')
	assertTextPresent('Tagged Java,  Cool job')
	assertTextPresent('Play developper wanted - Paris')
	assertTextPresent('http://www.zenexity.com')
	
	// Back
	clickAndWait('link=Back *')
	assertText('css=a.selected', 'Development')
	
	// Try tags filter
	clickAndWait('link=Cool*')
	assertTextPresent('Tagged with cool')
	assertTextPresent('Play developper wanted at Zenexity - Paris')
	assertTextPresent('PHP developper wanted at Google - Chicago')
	
	clickAndWait('link=Java*')
	assertTextPresent('Tagged with cool, java')
	assertTextPresent('Play developper wanted at Zenexity - Paris')
	assertTextNotPresent('PHP developper wanted at Google - Chicago')
	
	clickAndWait('link=PHP*')
	assertTextPresent('Tagged with cool, java, php')
	assertTextPresent('No jobs ...')
	assertTextNotPresent('Play developper wanted at Zenexity - Paris')
	assertTextNotPresent('PHP developper wanted at Google - Chicago')

	clickAndWait('link=Java*')
	assertTextPresent('Tagged with cool, php')
	assertTextNotPresent('No jobs ...')
	assertTextNotPresent('Play developper wanted at Zenexity - Paris')
	assertTextPresent('PHP developper wanted at Google - Chicago')	
	
	// Reset filter
	clickAndWait('link=*remove this filter*')
	assertTextNotPresent('Tagged')
	assertTextPresent('Play developper wanted at Zenexity - Paris')
	assertTextPresent('PHP developper wanted at Google - Chicago')
	
	// Try the search engine
	type('keywords', 'zenexity')
	clickAndWait('searchButton')
	assertTextPresent('1 job match your request.')
	assertTextPresent('Play developper wanted at Zenexity - Paris')
	
	type('keywords', 'google')
	clickAndWait('searchButton')
	assertTextPresent('2 jobs match your request.')
	assertTextPresent('CEO wanted at Google - San Fransisco')
	
	// Cancel the search
	clickAndWait('link=*Cancel*')
	assertText('css=a.selected', 'Development')
	assertTextPresent('Play developper wanted at Zenexity - Paris')
	assertTextPresent('PHP developper wanted at Google - Chicago')
	
#{/selenium}