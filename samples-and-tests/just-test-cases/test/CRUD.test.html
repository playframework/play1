#{fixture delete:'all' /}

#{selenium 'Test the CRUD module'}
	
	open('@{CRUD.index()}')
	assertPath('/admin')
	
	// Create a company
	clickAndWait('link=AdminCompany')
	assertTextPresent('0 AdminCompany')
	assertPath('/admin/admincompany')
	clickAndWait('link=Add Company')
	assertPath('/admin/admincompany/new')
	type('object_name', 'Zenexity')
	clickAndWait('css=input[name=_save]')
	assertTextPresent('has been created')
	assertTextPresent('Zenexity')
	assertPath('/admin/admincompany')
	clickAndWait('link=Zenexity')
	assertTextPresent('Edit Company')
	
	// Create a project
	clickAndWait('link=Home')
	assertPath('/admin')
	clickAndWait('link=Projects')
	assertPath('/admin/projects')
	assertTextPresent('0 Projects')
	clickAndWait('link=Add Project')
	assertPath('/admin/projects/new')
	type('object_name', 'Play')
	select('object_company', 'Zenexity')
	clickAndWait('css=input[name=_save]')
	assertTextPresent('has been created')
	assertTextPresent('Play belongs to Zenexity')
	clickAndWait('link=Play belongs to Zenexity')
	assertTextPresent('Edit Project')
	
	// Create a factory
	clickAndWait('link=Home')
	assertPath('/admin')
	clickAndWait('link=Factories')
	assertPath('/admin/factories')
	assertTextPresent('0 Factories')
	clickAndWait('link=Add Factory')
	assertPath('/admin/factories/new')
	type('object_name', 'Cars')
	clickAndWait('css=input[name=_save]')
	assertTextPresent('has been created')
	assertTextPresent('Cars')
	clickAndWait('link=Cars')
	assertTextPresent('Edit Factory')
	type('object_name', 'Cars !!!!')
	clickAndWait('css=input[name=_save]')
	assertTextPresent('Cars !!!!')
	
	// Update te project
	clickAndWait('link=Home')
	clickAndWait('link=Projects')
	clickAndWait('link=Play belongs to Zenexity')
	select('object_company', '(Please select a value)')
	clickAndWait('css=input[name=_save]')
	assertTextPresent('Please correct error')
	type('object_name', 'Poupou')
	clickAndWait('css=input[name=_save]')
	clickAndWait('link=Home')
	clickAndWait('link=Projects')
	assertTextPresent('Play belongs to Zenexity')
	assertTextNotPresent('Poupou')
	
	// Create an item
	clickAndWait('link=Home')
	clickAndWait('link=Items')
	clickAndWait('link=Add Item')
	type('object_name', '607')
    type('object_sku', '607')
    clickAndWait('css=input[name=_save]')
    assertTextPresent('Item[607]')
    clickAndWait('link=Item[607]')
    assertSelected('object_factory', '(None)')
    select('object_factory', 'Cars !!!!')
    clickAndWait('css=input[name=_save]')
    clickAndWait('link=Item[607]')
    assertSelected('object_factory', 'Cars !!!!')
		
#{/selenium}